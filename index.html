<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>U.S.A. Parts Made Fast</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;800;900&family=Barlow:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0d0d;
    --surface: #141414;
    --surface2: #1c1c1c;
    --surface3: #222;
    --border: #2a2a2a;
    --accent: #e8a020;
    --accent2: #c0392b;
    --text: #e8e8e8;
    --muted: #888;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Barlow', sans-serif;
    font-size: 15px;
    line-height: 1.5;
    min-height: 100vh;
  }

  /* HEADER */
  header {
    background: var(--surface);
    border-bottom: 3px solid var(--accent);
    padding: 24px 40px 20px;
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 20px;
    flex-wrap: wrap;
  }
  .flag-stripe { display: flex; gap: 4px; margin-bottom: 8px; }
  .flag-stripe span { display: block; height: 5px; border-radius: 2px; }
  .flag-stripe .red   { background: #b22234; width: 40px; }
  .flag-stripe .white { background: #eee;    width: 40px; }
  .flag-stripe .blue  { background: #3c3b6e; width: 40px; }
  h1 {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 44px; font-weight: 900;
    letter-spacing: 1px; line-height: 1;
    color: #fff; text-transform: uppercase;
  }
  h1 span { color: var(--accent); }
  .tagline { margin-top: 8px; color: var(--muted); font-size: 14px; max-width: 520px; line-height: 1.6; }
  .header-actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; padding-top: 4px; }

  /* BUTTONS */
  .btn {
    display: inline-flex; align-items: center; gap: 7px;
    padding: 9px 18px; border-radius: 4px;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 15px; font-weight: 700; letter-spacing: 0.5px;
    text-transform: uppercase; cursor: pointer; border: none;
    text-decoration: none; transition: all 0.15s; white-space: nowrap;
  }
  .btn-primary  { background: var(--accent); color: #000; }
  .btn-primary:hover  { background: #f5b840; }
  .btn-outline  { background: transparent; color: var(--text); border: 1.5px solid var(--border); }
  .btn-outline:hover  { border-color: var(--accent); color: var(--accent); }
  .btn-danger   { background: var(--accent2); color: #fff; font-size: 12px; padding: 5px 10px; }
  .btn-danger:hover   { background: #e74c3c; }
  .btn-warn     { background: #2c1f05; color: var(--accent); border: 1.5px solid var(--accent); font-size: 12px; padding: 5px 10px; }
  .btn-warn:hover     { background: var(--accent); color: #000; }
  .btn-instant  { background: #1a1a1a; color: #ccc; border: 1.5px solid #444; }
  .btn-instant:hover  { border-color: #4ade80; color: #4ade80; background: #0a1a0a; }
  .btn-instant.active { background: #052e16; color: #4ade80; border-color: #166534; }
  .btn-uber     { background: #1a1a1a; color: #ccc; border: 1.5px solid #444; }
  .btn-uber:hover     { border-color: #c4b5fd; color: #c4b5fd; background: #100a1a; }
  .btn-uber.active    { background: #1a0a2e; color: #c4b5fd; border-color: #6d28d9; }

  /* TOOLBAR */
  .toolbar {
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
    padding: 12px 40px;
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
    position: sticky;
    top: 0;
    z-index: 90;
  }

  /* Search */
  .search-wrap { position: relative; flex: 1; min-width: 160px; max-width: 260px; }
  .search-wrap .ico {
    position: absolute; left: 11px; top: 50%;
    transform: translateY(-50%); color: var(--muted); font-size: 14px; pointer-events: none;
  }
  .search-wrap input {
    width: 100%; background: #1a1a1a;
    border: 1.5px solid #444; border-radius: 4px;
    color: var(--text); font-family: 'Barlow', sans-serif;
    font-size: 14px; padding: 8px 12px 8px 32px; outline: none;
    transition: border-color 0.15s;
  }
  .search-wrap input:focus { border-color: var(--accent); }
  .search-wrap input::placeholder { color: var(--muted); }

  /* Dropdowns */
  .dropdown-wrap { position: relative; }
  .dropdown-trigger {
    display: flex; align-items: center; gap: 8px;
    background: #1a1a1a; border: 1.5px solid #444;
    border-radius: 4px; color: #ccc;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 15px; font-weight: 600; letter-spacing: 0.3px;
    padding: 8px 14px; cursor: pointer; white-space: nowrap;
    min-width: 180px; justify-content: space-between;
    transition: border-color 0.15s; user-select: none;
  }
  .dropdown-trigger:hover,
  .dropdown-trigger.open { border-color: var(--accent); color: var(--accent); }
  .dropdown-trigger .arrow { font-size: 10px; transition: transform 0.2s; opacity: 0.6; }
  .dropdown-trigger.open .arrow { transform: rotate(180deg); }
  .dropdown-trigger .selected-val { flex: 1; text-align: left; overflow: hidden; text-overflow: ellipsis; }

  .dropdown-menu {
    display: none; position: absolute; top: calc(100% + 4px); left: 0;
    min-width: 100%; background: var(--surface2);
    border: 1.5px solid var(--accent); border-radius: 4px;
    z-index: 200; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.6);
  }
  .dropdown-menu.open { display: block; }
  .dropdown-search { padding: 8px; border-bottom: 1px solid var(--border); }
  .dropdown-search input {
    width: 100%; background: var(--surface); border: 1px solid var(--border);
    border-radius: 3px; color: var(--text);
    font-family: 'Barlow', sans-serif; font-size: 13px;
    padding: 6px 10px; outline: none;
  }
  .dropdown-search input:focus { border-color: var(--accent); }
  .dropdown-search input::placeholder { color: var(--muted); }
  .dropdown-list { max-height: 260px; overflow-y: auto; }
  .dropdown-list::-webkit-scrollbar { width: 4px; }
  .dropdown-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
  .dropdown-item {
    padding: 9px 14px; cursor: pointer; font-size: 14px;
    display: flex; align-items: center; gap: 8px;
    transition: background 0.1s; white-space: nowrap;
  }
  .dropdown-item:hover { background: var(--surface3); color: var(--accent); }
  .dropdown-item.selected { color: var(--accent); background: #1a1200; }
  .dropdown-item.all-option { color: var(--muted); border-bottom: 1px solid var(--border); font-style: italic; }
  .dropdown-item.all-option.selected { color: var(--accent); }

  .divider { width: 1px; height: 24px; background: var(--border); flex-shrink: 0; }

  .clear-btn {
    background: none; border: none; color: var(--muted);
    font-size: 12px; font-family: 'Barlow', sans-serif;
    cursor: pointer; text-decoration: underline; white-space: nowrap;
  }
  .clear-btn:hover { color: var(--accent); }

  .result-bar { margin-left: auto; color: var(--muted); font-size: 13px; white-space: nowrap; }
  .result-bar strong { color: var(--accent); }

  /* MAIN */
  main { max-width: 1200px; margin: 0 auto; padding: 36px 40px 80px; }

  .category-section { margin-bottom: 48px; }
  .category-header {
    display: flex; align-items: center; gap: 12px;
    margin-bottom: 16px; padding-bottom: 12px;
    border-bottom: 2px solid var(--border);
  }
  .category-icon {
    font-size: 20px; width: 40px; height: 40px;
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 6px; display: flex; align-items: center;
    justify-content: center; flex-shrink: 0;
  }
  .category-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 26px; font-weight: 800;
    text-transform: uppercase; letter-spacing: 1px; color: #fff;
  }
  .category-count { margin-left: auto; font-size: 12px; color: var(--muted); font-family: 'Barlow Condensed', sans-serif; letter-spacing: 1px; text-transform: uppercase; }
  .section-stripe { height: 1px; background: linear-gradient(to right, var(--accent), transparent); margin-bottom: 16px; opacity: 0.35; }

  .mfr-list { display: flex; flex-direction: column; gap: 2px; }
  .mfr-card {
    background: var(--surface); border: 1px solid var(--border);
    border-left: 3px solid transparent; border-radius: 4px;
    padding: 12px 16px;
    display: flex; flex-direction: column; gap: 6px;
    transition: all 0.15s;
    animation: fadeIn 0.2s ease both;
  }
  .mfr-card:hover { background: var(--surface2); border-left-color: var(--accent); }
  .mfr-card-top {
    display: flex; align-items: center; gap: 14px; flex-wrap: wrap;
  }
  .mfr-card-bottom {
    display: flex; align-items: center; gap: 14px; flex-wrap: wrap;
    padding-top: 4px; border-top: 1px solid var(--border);
  }
  .mfr-machines {
    font-size: 12px;
    font-family: 'Barlow', sans-serif;
    color: #bbb;
    flex: 1;
  }
  .cap-label {
    color: var(--accent);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    margin-right: 4px;
  }
  .mfr-name {
    font-family: 'Barlow Condensed', sans-serif; font-size: 20px;
    font-weight: 700; color: #fff; text-decoration: none;
    transition: color 0.15s;
  }
  .mfr-name:hover { color: var(--accent); }
  .mfr-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; flex: 1; }
  .mfr-location {
    font-size: 12px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    color: #9ca3af;
    letter-spacing: 0.4px;
    text-transform: uppercase;
    white-space: nowrap;
    display: flex; align-items: center; gap: 4px;
  }
  .mfr-dims {
    flex-shrink: 0;
    font-size: 12px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    letter-spacing: 0.5px;
    color: #aaa;
    text-transform: uppercase;
    white-space: nowrap;
    align-self: center;
    line-height: 1.5;
    text-align: right;
    margin-left: auto;
  }
  .tag {
    display: inline-flex; align-items: center; gap: 4px;
    padding: 3px 9px; border-radius: 3px; font-size: 12px;
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    letter-spacing: 0.4px; text-transform: uppercase; white-space: nowrap;
  }
  .tag-state        { background: #111827; border: 1px solid #374151; color: #9ca3af; }
  .tag-instant      { background: #052e16; border: 1px solid #166534; color: #4ade80; }
  .tag-manual       { background: #172554; border: 1px solid #1e40af; color: #93c5fd; }
  .tag-online-manual{ background: #172554; border: 1px solid #1e40af; color: #93c5fd; }
  .tag-email        { background: #1c1008; border: 1px solid #78350f; color: #fbbf24; }
  .tag-uber         { background: #1a0a2e; border: 1px solid #6d28d9; color: #c4b5fd; }
  .tag-beta         { background: #1a100a; border: 1px solid #92400e; color: #fbbf24; }
  .tag-dims         { background: #111; border: 1px solid #333; color: #666; font-size: 11px; }
  .mfr-actions { display: flex; gap: 6px; flex-shrink: 0; }
  .add-mfr-btn {
    display: inline-flex;
    align-items: center;
    margin-top: 8px;
    background: #1c1400;
    border: 1px dashed var(--accent);
    border-radius: 4px;
    color: var(--accent);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    padding: 6px 14px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.15s;
  }
  .add-mfr-btn:hover { background: var(--accent); color: #000; border-style: solid; }

  .add-info-btn {
    background: none;
    border: 1px dashed #555;
    border-radius: 3px;
    color: #777;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    padding: 2px 8px;
    cursor: pointer;
    white-space: nowrap;
    text-decoration: none;
    transition: all 0.15s;
    display: inline-flex;
    align-items: center;
  }
  .add-info-btn:hover { border-color: var(--accent); color: var(--accent); }

  /* Empty state */
  .empty-state { text-align: center; padding: 80px 20px; color: var(--muted); }
  .empty-state .empty-icon { font-size: 48px; margin-bottom: 16px; }
  .empty-state h3 { font-size: 22px; margin-bottom: 8px; color: var(--text); }

  /* MODALS */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.85); z-index: 1000;
    justify-content: center; align-items: center; padding: 20px;
  }
  .modal-overlay.active { display: flex; }
  .modal {
    background: var(--surface); border: 1px solid var(--border);
    border-top: 3px solid var(--accent); border-radius: 6px;
    padding: 32px; max-width: 480px; width: 100%; position: relative;
  }
  .modal h3 { font-family: 'Barlow Condensed', sans-serif; font-size: 22px; font-weight: 800; text-transform: uppercase; margin-bottom: 6px; }
  .modal p { color: var(--muted); font-size: 13px; margin-bottom: 20px; }
  .modal .close-btn { position: absolute; top: 14px; right: 16px; background: none; border: none; color: var(--muted); font-size: 22px; cursor: pointer; line-height: 1; }
  .modal .close-btn:hover { color: #fff; }
  .modal-options { display: flex; flex-direction: column; gap: 12px; }
  .modal-option-btn {
    display: flex; align-items: center; gap: 12px; padding: 16px;
    background: var(--surface2); border: 1.5px solid var(--border);
    border-radius: 6px; cursor: pointer; text-decoration: none;
    color: var(--text); transition: all 0.15s;
  }
  .modal-option-btn:hover { border-color: var(--accent); background: #1a1200; }
  .modal-option-btn .opt-icon { font-size: 24px; flex-shrink: 0; }
  .modal-option-btn .opt-label { font-family: 'Barlow Condensed', sans-serif; font-size: 16px; font-weight: 700; text-transform: uppercase; }
  .modal-option-btn .opt-sub { font-size: 12px; color: var(--muted); }

  /* FOOTER */
  footer { background: var(--surface); border-top: 1px solid var(--border); padding: 24px 40px; text-align: center; color: var(--muted); font-size: 13px; }
  footer a { color: var(--accent); text-decoration: none; }

  @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }


  @media (max-width: 768px) {
    header { padding: 20px; }
    h1 { font-size: 32px; }
    .toolbar { padding: 10px 16px; gap: 8px; }
    main { padding: 24px 16px 60px; }
    .search-wrap { max-width: 100%; min-width: 100%; }
    .dropdown-trigger { min-width: 140px; }
    .mfr-card { flex-direction: column; align-items: flex-start; }
    .mfr-actions { margin-left: 0; flex-wrap: wrap; }
    .result-bar { order: -1; width: 100%; margin-left: 0; }
  }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div>
    <div class="flag-stripe">
      <span class="red"></span><span class="white"></span><span class="blue"></span>
    </div>
    <h1>U.S.A. <span>Parts Made Fast</span></h1>
    <p class="tagline">U.S.-based manufacturers offering quick-turn solutions.<br>Parts delivered to your door <strong>in under 7 days</strong>, assemblies <strong>... a little bit after that</strong>.</p>
    <p class="tagline" style="margin-top:20px; font-size:13px; font-style:italic;">My hope is that this list helps you find quick-turn partners ‚Äî and reveals where gaps exist: processes still waiting to be brought to quick-turn, and legacy industries yet to unlock instant quoting.</p>
  </div>
  <div class="header-actions">
    <button class="btn btn-primary" onclick="openModal('submit-modal')">‚ûï Submit Manufacturer</button>
    <a class="btn btn-outline" id="report-incorrect-btn" href="#" target="_blank">‚öë Report Incorrect Information</a>
  </div>
</header>

<!-- ALWAYS-VISIBLE TOOLBAR -->
<div class="toolbar">

  <!-- Text search -->
  <div class="search-wrap">
    <span class="ico">üîç</span>
    <input type="text" id="search-input" placeholder="Search processes‚Ä¶" oninput="applyFilters()">
  </div>

  <div class="divider"></div>

  <!-- Process dropdown -->
  <div class="dropdown-wrap" id="process-wrap">
    <div class="dropdown-trigger" id="process-trigger" onclick="toggleDropdown('process')">
      <span class="selected-val" id="process-label">All Processes</span>
      <span class="arrow">‚ñº</span>
    </div>
    <div class="dropdown-menu" id="process-menu">
      <div class="dropdown-search">
        <input type="text" placeholder="Search process‚Ä¶" oninput="filterDropdownItems('process', this.value)">
      </div>
      <div class="dropdown-list" id="process-list"></div>
    </div>
  </div>

  <!-- State dropdown -->
  <div class="dropdown-wrap" id="state-wrap">
    <div class="dropdown-trigger" id="state-trigger" onclick="toggleDropdown('state')">
      <span class="selected-val" id="state-label">All States</span>
      <span class="arrow">‚ñº</span>
    </div>
    <div class="dropdown-menu" id="state-menu">
      <div class="dropdown-search">
        <input type="text" placeholder="Search state‚Ä¶" oninput="filterDropdownItems('state', this.value)">
      </div>
      <div class="dropdown-list" id="state-list"></div>
    </div>
  </div>

  <div class="divider"></div>

  <!-- Instant quote toggle -->
  <button class="btn btn-instant" id="instant-btn" onclick="toggleInstant()">‚ö° Instant Quote Only</button>

  <!-- Uber carrier toggle -->
  <button class="btn btn-uber" id="uber-btn" onclick="toggleUber()">üöó Uber Courier Available</button>

  <!-- Clear -->
  <button class="clear-btn" id="clear-btn" onclick="clearFilters()" style="display:none">‚úï Clear filters</button>


</div>

<!-- BETA DISCLAIMER -->
<p style="text-align:center; padding: 10px 40px 0; font-size:12px; color:var(--accent);">Manufacturers marked <strong>Beta</strong> may be in closed beta or not yet at full production capacity.</p>
<p style="text-align:center; padding: 20px 40px 0; font-size:11px; color:var(--muted); letter-spacing:0.3px;">Categories and manufacturers are reshuffled on every page load ‚Äî no placement is paid or permanent.</p>

<!-- MAIN -->
<main id="main-content"></main>

<!-- REQUEST PROCESS -->
<div style="text-align:center; padding: 16px 40px 60px;">
  <a id="request-process-link" href="#" target="_blank"
     style="display:inline-flex; align-items:center; gap:10px;
            background:var(--accent); color:#000;
            font-family:'Barlow Condensed',sans-serif; font-size:20px;
            font-weight:800; letter-spacing:1px; text-transform:uppercase;
            text-decoration:none; padding:16px 36px; border-radius:4px;
            transition:background 0.15s;">
    ‚ûï Request a Manufacturing Process
  </a>
  <p style="margin-top:12px; font-size:13px; color:var(--muted);">Don't see your process? Request it and we'll work to find a quick-turn supplier.</p>
</div>

<!-- FOOTER -->
<footer>
  <p>üá∫üá∏ <strong>U.S.A. Parts Made Fast</strong> ‚Äî A community-curated directory of quick-turn American manufacturers.</p>
  <p style="margin-top:6px;">Something missing? <a href="#" onclick="openModal('submit-modal');return false;">Submit a manufacturer</a> ¬∑ <a id="report-incorrect-footer" href="#" target="_blank">Report incorrect information</a></p>
</footer>

<!-- SUBMIT MODAL -->
<div class="modal-overlay" id="submit-modal">
  <div class="modal">
    <button class="close-btn" onclick="closeModal('submit-modal')">‚úï</button>
    <h3>Submit a Manufacturer</h3>
    <p>Know a U.S. shop that delivers parts in under 7 days? Submit it and we'll review it for the directory.</p>
    <div class="modal-options">
      <a class="modal-option-btn" id="submit-link" href="#" target="_blank">
        <span class="opt-icon">üè≠</span>
        <div>
          <div class="opt-label">Submit New Manufacturer</div>
          <div class="opt-sub">Shop name, URL, state, capabilities &amp; quote type</div>
        </div>
      </a>
    </div>
  </div>
</div>

<a id="incorrect-info-link" href="#" target="_blank" style="display:none"></a>

<script>
// ‚îÄ‚îÄ FORM LINKS ‚Äî replace with your real Google Form URLs ‚îÄ‚îÄ
const FORM_LINKS = {
  submit:         "https://docs.google.com/forms/d/e/YOUR_SUBMIT_FORM_ID/viewform",
  incorrectInfo:  "https://docs.google.com/forms/d/e/YOUR_INCORRECT_INFO_FORM_ID/viewform",
  requestProcess: "https://docs.google.com/forms/d/e/YOUR_REQUEST_PROCESS_FORM_ID/viewform",
};
document.getElementById('submit-link').href            = FORM_LINKS.submit;
document.getElementById('incorrect-info-link').href    = FORM_LINKS.incorrectInfo;
document.getElementById('report-incorrect-btn').href   = FORM_LINKS.incorrectInfo;
document.getElementById('report-incorrect-footer').href= FORM_LINKS.incorrectInfo;
document.getElementById('request-process-link').href   = FORM_LINKS.requestProcess;

// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
// quote: "instant" | "online-manual" | "email"
// uber: bool, beta: bool
// dims: { "Category Name": { min: string|null, max: string|null } }
// machines: { "Category Name": { equip: [...], post: [...] } }
//   equip = physical machines/equipment, post = secondary processes & finishing
const manufacturers = [
  { name: "SendCutSend",      url: "https://sendcutsend.com",               city: "Reno",          state: "NV", quote: "instant",       uber: false, beta: false,
    dims: { "Laser Cutting": { min: '1" x 1"', max: '44" x 30"' }, "Waterjet Cutting": { min: '1" x 1"', max: '44" x 30"' }, "CNC Machining": { min: '1" x 1" x 1"', max: '7" x 7" x 12"' } },
    machines: {
      "Laser Cutting":   { equip: ["Fiber Laser", "CO2 Laser", "Press Brake"],    post: ["Bending", "Powder Coating", "Anodizing", "Zinc Plating", "Tapping", "Hardware Insertion", "Countersinking", "Dimple Forming", "Deburring"] },
      "Waterjet Cutting":{ equip: ["Waterjet"],                                    post: [] },
      "CNC Machining":   { equip: ["3-axis CNC", "5-axis CNC"],                   post: [] },
      "Tube Cutting":    { equip: ["Tube Laser"],                                  post: [] },
    },
    categories: ["Laser Cutting","Waterjet Cutting","CNC Machining","Tube Cutting"] },
  { name: "Fabworks",         url: "https://www.fabworks.com",              city: "Ventura",       state: "CA", quote: "instant",       uber: false, beta: false,
    dims: { "Laser Cutting": { min: null, max: '60" x 120"' } },
    machines: {
      "Laser Cutting": { equip: ["Fiber Laser", "Press Brake"], post: ["Bending", "Powder Coating", "Tapping", "Hardware Insertion", "Countersinking"] },
      "Tube Cutting":  { equip: ["5-axis Tube Laser"],          post: [] },
    },
    categories: ["Laser Cutting","Tube Cutting"] },
  { name: "RMFG",             url: "https://www.rmfg.com",                  city: "Fort Worth",    state: "TX", quote: "instant",       uber: false, beta: false,
    dims: { "Laser Cutting": { min: null, max: '48" x 96"' } },
    machines: {
      "Laser Cutting":      { equip: ["Fiber Laser", "Press Brake"], post: ["Bending"] },
      "Welding & Assembly": { equip: ["MIG Welder", "TIG Welder"],   post: [] },
    },
    categories: ["Laser Cutting","Welding & Assembly"] },
  { name: "OSH Cut",          url: "https://www.oshcut.com",                city: "Columbus",      state: "OH", quote: "instant",       uber: false, beta: false,
    dims: { "Laser Cutting": { min: '1" x 1"', max: '60" x 120"' }, "Tube Cutting": { min: null, max: '10" diameter' }, "Tube & Pipe Bending": { min: '0.75" OD', max: '1.5" OD' } },
    machines: {
      "Laser Cutting":        { equip: ["Fiber Laser", "Press Brake"],  post: ["Bending", "Powder Coating", "Bead Blasting", "Tumbling", "Tapping", "Hardware Insertion", "Countersinking", "Deburring"] },
      "Tube Cutting":         { equip: ["Tube Laser"],                   post: [] },
      "Tube & Pipe Bending":  { equip: ["CNC Tube Bender"],              post: ["Tube Bending"] },
    },
    categories: ["Laser Cutting","Tube Cutting","Tube & Pipe Bending"] },
  { name: "Digital Metal",    url: "https://www.digitalmetal.io",           city: "San Francisco", state: "CA", quote: "instant",       uber: false, beta: false,
    dims: { "Casting & Forging": { min: null, max: '~19.7" (500mm)' } },
    machines: {
      "Casting & Forging": { equip: ["Investment Casting"], post: ["Polishing", "Sandblasting"] },
    },
    categories: ["Casting & Forging"] },
  { name: "FinalRev",         url: "https://www.finalrev.com",              city: "Berkeley",      state: "CA", quote: "online-manual", uber: false, beta: true,
    dims: {},
    machines: {
      "Laser Cutting":   { equip: ["Fiber Laser"], post: [] },
      "Waterjet Cutting":{ equip: ["Waterjet"],    post: [] },
      "CNC Machining":   { equip: ["3-axis CNC", "5-axis CNC"],  post: [] },
      "Turning":         { equip: ["Millturn"],                 post: [] },
    },
    categories: ["Laser Cutting","Waterjet Cutting","CNC Machining","Turning"] },
  { name: "Foundation",       url: "https://www.foundation-industries.com", city: null,            state: null, quote: "online-manual", uber: false, beta: true,
    dims: {},
    machines: {
      "CNC Machining": { equip: ["3-axis CNC", "5-axis CNC"], post: [] },
    },
    categories: ["CNC Machining"] },
  { name: "Loombotic",        url: "https://loombotic.com",                 city: "Toronto",       state: "ON", quote: "instant",       uber: false, beta: false,
    dims: {},
    machines: {
      "Cable Harnessing": { equip: ["Automated Assembly"], post: ["Wire Harness Assembly"] },
    },
    categories: ["Cable Harnessing"] },
  { name: "Nox Metals",       url: "https://www.noxmetals.co",              city: "Detroit",       state: "MI", quote: "instant",       uber: false, beta: false,
    dims: {},
    machines: {
      "Raw Materials": { equip: ["Big Ass Saw", "Smaller Saws"], post: [] },
    },
    categories: ["Raw Materials"] },
  { name: "Nebula",           url: "https://buildnebula.com",               city: "El Segundo",    state: "CA", quote: "instant",       uber: false, beta: true,
    dims: {},
    machines: {
      "PCBA": { equip: [], post: ["SMT Assembly"] },
    },
    categories: ["PCBA"] },
  { name: "Blitz Panel",      url: "https://blitzpanel.com",                city: "Austin",        state: "TX", quote: "instant",       uber: false, beta: false,
    dims: {},
    machines: {
      "Control Panel Fabrication": { equip: [], post: ["UL 508A", "DIN-rail Assembly"] },
    },
    categories: ["Control Panel Fabrication"] },
  { name: "Senra Systems",    url: "https://www.senrasystems.us",           city: "Redondo Beach", state: "CA", quote: "online-manual", uber: false, beta: true,
    dims: {},
    machines: {
      "Cable Harnessing": { equip: ["Automated Assembly"], post: ["Aerospace Wire Harness", "Formboard Assembly"] },
    },
    categories: ["Cable Harnessing"] },
  { name: "Podium Automation",url: "https://www.podiumautomation.com",      city: "Brooklyn",      state: "NY", quote: "online-manual", uber: false, beta: false,
    dims: {},
    machines: {
      "Control Panel Fabrication": { equip: [], post: ["UL 508A", "UL 698A"] },
    },
    categories: ["Control Panel Fabrication"] },
  { name: "Ponoko",           url: "https://www.ponoko.com",                city: "Oakland",       state: "CA", quote: "instant",       uber: false, beta: false,
    dims: { "Laser Cutting": { min: null, max: '~31" x 15"' } },
    machines: {
      "Laser Cutting": { equip: ["CO2 Laser", "Fiber Laser", "Press Brake"], post: ["Bending", "Powder Coating", "UV Printing", "Tapping"] },
    },
    categories: ["Laser Cutting"] },
  { name: "JawsTec",          url: "https://www.jawstec.com",               city: "American Falls",state: "ID", quote: "instant",       uber: false, beta: false,
    dims: { "3D Printing": { min: null, max: 'MJF: 15"√ó11"√ó15" ¬∑ SLS: 15"√ó27.6"√ó22.8"' } },
    machines: {
      "3D Printing": { equip: ["MJF", "SLS", "SLA", "FDM"], post: [] },
    },
    categories: ["3D Printing"] },
];

const allCategories = [
  { name: "CNC Machining",            icon: "‚öôÔ∏è" },
  { name: "Turning",                  icon: "üîÅ" },
  { name: "Wire EDM",                 icon: "‚ö°" },
  { name: "Casting & Forging",        icon: "üî•" },
  { name: "Metal Stamping",           icon: "üî®" },
  { name: "Ceramics & Glass",         icon: "üè∫" },
  { name: "Waterjet Cutting",         icon: "üíß" },
  { name: "Laser Cutting",            icon: "üî¶" },
  { name: "Tube Cutting",             icon: "‚úÇÔ∏è" },
  { name: "Tube & Pipe Bending",      icon: "üîÑ" },
  { name: "3D Printing",              icon: "üñ®Ô∏è" },
  { name: "Injection Molding",        icon: "üß™" },
  { name: "Urethane Casting",         icon: "üß´" },
  { name: "Extrusion",                icon: "üìè" },
  { name: "Welding & Assembly",       icon: "üîß" },
  { name: "PCB Fabrication",          icon: "üîå" },
  { name: "PCBA",                     icon: "üñ•Ô∏è" },
  { name: "Control Panel Fabrication",icon: "üî≤" },
  { name: "Cable Harnessing",         icon: "ü™¢" },
  { name: "Raw Materials",            icon: "üèóÔ∏è" },
];

// ‚îÄ‚îÄ FILTER STATE ‚îÄ‚îÄ
let selectedProcess = null;
let selectedState   = null;
let instantOnly     = false;
let uberOnly        = false;

// ‚îÄ‚îÄ BUILD DROPDOWNS ‚îÄ‚îÄ
function buildDropdowns() {
  const procList = document.getElementById('process-list');
  procList.innerHTML =
    `<div class="dropdown-item all-option selected" data-value="" onclick="selectDropdown('process',null,'All Processes')">All Processes</div>` +
    allCategories.map(c =>
      `<div class="dropdown-item" data-value="${c.name}" onclick="selectDropdown('process','${c.name.replace(/'/g,"\\'")}','${c.icon} ${c.name.replace(/'/g,"\\'")}')">${c.icon} ${c.name}</div>`
    ).join('');

  const states = [...new Set(manufacturers.map(m => m.state))].sort();
  const stateList = document.getElementById('state-list');
  stateList.innerHTML =
    `<div class="dropdown-item all-option selected" data-value="" onclick="selectDropdown('state',null,'All States')">All States</div>` +
    states.map(s =>
      `<div class="dropdown-item" data-value="${s}" onclick="selectDropdown('state','${s}','üìç ${s}')">üìç ${s}</div>`
    ).join('');
}

function toggleDropdown(id) {
  const menu    = document.getElementById(id + '-menu');
  const trigger = document.getElementById(id + '-trigger');
  const isOpen  = menu.classList.contains('open');
  document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
  document.querySelectorAll('.dropdown-trigger').forEach(t => t.classList.remove('open'));
  if (!isOpen) {
    menu.classList.add('open');
    trigger.classList.add('open');
    const si = menu.querySelector('input');
    if (si) { si.value = ''; filterDropdownItems(id, ''); si.focus(); }
  }
}

function selectDropdown(type, value, label) {
  if (type === 'process') {
    selectedProcess = value;
    document.getElementById('process-label').textContent = label;
    document.querySelectorAll('#process-list .dropdown-item').forEach(el =>
      el.classList.toggle('selected', el.dataset.value === (value || '')));
    document.getElementById('process-menu').classList.remove('open');
    document.getElementById('process-trigger').classList.remove('open');
  } else {
    selectedState = value;
    document.getElementById('state-label').textContent = label;
    document.querySelectorAll('#state-list .dropdown-item').forEach(el =>
      el.classList.toggle('selected', el.dataset.value === (value || '')));
    document.getElementById('state-menu').classList.remove('open');
    document.getElementById('state-trigger').classList.remove('open');
  }
  applyFilters();
}

function filterDropdownItems(id, query) {
  const q = query.toLowerCase();
  document.getElementById(id + '-list').querySelectorAll('.dropdown-item').forEach(el => {
    if (el.classList.contains('all-option')) { el.style.display = ''; return; }
    el.style.display = el.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
}

function toggleInstant() {
  instantOnly = !instantOnly;
  document.getElementById('instant-btn').classList.toggle('active', instantOnly);
  applyFilters();
}

function toggleUber() {
  uberOnly = !uberOnly;
  document.getElementById('uber-btn').classList.toggle('active', uberOnly);
  applyFilters();
}

function clearFilters() {
  selectedProcess = null; selectedState = null; instantOnly = false; uberOnly = false;
  document.getElementById('search-input').value = '';
  document.getElementById('process-label').textContent = 'All Processes';
  document.getElementById('state-label').textContent   = 'All States';
  document.getElementById('instant-btn').classList.remove('active');
  document.getElementById('uber-btn').classList.remove('active');
  document.querySelectorAll('#process-list .dropdown-item').forEach(el => el.classList.toggle('selected', el.dataset.value === ''));
  document.querySelectorAll('#state-list .dropdown-item').forEach(el  => el.classList.toggle('selected', el.dataset.value === ''));
  applyFilters();
}

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ
function applyFilters() {
  const query = document.getElementById('search-input').value.toLowerCase().trim();
  const isFiltered = selectedProcess || selectedState || instantOnly || uberOnly || query;
  document.getElementById('clear-btn').style.display = isFiltered ? '' : 'none';

  const catsShuffled = shuffle(selectedProcess
    ? allCategories.filter(c => c.name === selectedProcess)
    : [...allCategories]);

  // Always show populated categories before empty ones
  const catsToShow = [
    ...catsShuffled.filter(cat => manufacturers.some(m => {
      if (!m.categories.includes(cat.name)) return false;
      if (selectedState && m.state !== selectedState) return false;
      if (instantOnly && m.quote !== 'instant') return false;
      if (uberOnly && !m.uber) return false;
      return true;
    })),
    ...catsShuffled.filter(cat => !manufacturers.some(m => {
      if (!m.categories.includes(cat.name)) return false;
      if (selectedState && m.state !== selectedState) return false;
      if (instantOnly && m.quote !== 'instant') return false;
      if (uberOnly && !m.uber) return false;
      return true;
    })),
  ];

  let totalVisible = 0;
  const html = catsToShow.map(cat => {
    // search filters by category/process name
    if (query && !cat.name.toLowerCase().includes(query)) return '';

    const matching = manufacturers.filter(m => {
      if (!m.categories.includes(cat.name)) return false;
      if (selectedState && m.state !== selectedState) return false;
      if (instantOnly && m.quote !== 'instant') return false;
      if (uberOnly && !m.uber) return false;
      return true;
    });
    if (!matching.length) {
      return `
      <div class="category-section">
        <div class="category-header">
          <div class="category-icon">${cat.icon}</div>
          <span class="category-title">${cat.name}</span>
        </div>
        <div class="section-stripe"></div>
        <a class="add-mfr-btn" href="${FORM_LINKS.submit}" target="_blank">+ Add Manufacturer</a>
      </div>`;
    }
    totalVisible += matching.length;

    const pins = (pinnedTop[cat.name] || [])
      .map(n => matching.find(m => m.name === n))
      .filter(Boolean);
    const rest = shuffle(matching.filter(m => !pins.includes(m)));
    const ordered = [...pins, ...rest];

    const cards = ordered.map((m, i) => {
      const catCaps = m.machines && m.machines[cat.name];
      const equipList = catCaps && catCaps.equip && catCaps.equip.length ? catCaps.equip.join(', ') : null;
      const postList  = catCaps && catCaps.post  && catCaps.post.length  ? catCaps.post.join(', ')  : null;
      const addInfoUrl = `${FORM_LINKS.incorrectInfo}?entry.mfr=${encodeURIComponent(m.name)}`;
      const addBtn = `<a class="add-info-btn" href="${addInfoUrl}" target="_blank">+ Add Info</a>`;

      const addEquipBtn = `<a class="add-info-btn" href="${addInfoUrl}" target="_blank">+ Add Machine</a>`;
      const addPostBtn  = `<a class="add-info-btn" href="${addInfoUrl}" target="_blank">+ Add Post Process</a>`;
      const machinesHtml = `<div style="display:flex;flex-direction:column;gap:4px;">
        <div class="mfr-machines"><span class="cap-label">Machines:</span> ${equipList ? equipList + ' ' : ''}${addEquipBtn}</div>
        <div class="mfr-machines"><span class="cap-label">Post Processes:</span> ${postList ? postList + ' ' : ''}${addPostBtn}</div>
      </div>`;

      const catDims = m.dims && m.dims[cat.name];
      const dimsHtml = `<div class="mfr-dims">${
        catDims && catDims.max ? `Max: ${catDims.max}` : `Max: ${addBtn}`
      }<br>${
        catDims && catDims.min ? `Min: ${catDims.min}` : `Min: ${addBtn}`
      }</div>`;

      return `
      <div class="mfr-card" style="animation-delay:${i*0.03}s">
        <div class="mfr-card-top">
          <div style="display:flex;align-items:center;gap:8px;">
            ${m.beta ? '<span class="tag tag-beta">Beta</span>' : ''}
            <a class="mfr-name" href="${m.url}" target="_blank" rel="noopener">${m.name} ‚Üó</a>
          </div>
          <div class="mfr-meta">
            ${m.quote==='instant'
              ? '<span class="tag tag-instant">‚ö° Instant Quote</span>'
              : m.quote==='online-manual'
              ? '<span class="tag tag-online-manual">üñ•Ô∏è Online Platform Manual Quote</span>'
              : '<span class="tag tag-email">‚úâÔ∏è Email Quote</span>'}
            ${m.uber ? '<span class="tag tag-uber">üöó Uber Courier</span>' : ''}
          </div>
        </div>
        <div class="mfr-card-bottom">
          ${(m.city || m.state) ? `<div class="mfr-location">üìç ${[m.city, m.state].filter(Boolean).join(', ')}</div>` : ''}
          ${machinesHtml}
          ${dimsHtml}
        </div>
      </div>`;
    }).join('');

    return `
      <div class="category-section">
        <div class="category-header">
          <div class="category-icon">${cat.icon}</div>
          <span class="category-title">${cat.name}</span>
        </div>
        <div class="section-stripe"></div>
        <div class="mfr-list">${cards}</div>
        <a class="add-mfr-btn" href="${FORM_LINKS.submit}" target="_blank">+ Add Manufacturer</a>
      </div>`;
  }).join('');

  document.getElementById('main-content').innerHTML = html ||
    `<div class="empty-state">
       <div class="empty-icon">üîç</div>
       <h3>No manufacturers match your filters</h3>
       <p>Try broadening your search or <button class="clear-btn" onclick="clearFilters()">clear filters</button>.</p>
     </div>`;

}

// ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ
function openModal(id)  { document.getElementById(id).classList.add('active'); }
function closeModal(id) { document.getElementById(id).classList.remove('active'); }

document.querySelectorAll('.modal-overlay').forEach(o =>
  o.addEventListener('click', function(e) { if (e.target===this) this.classList.remove('active'); }));
document.addEventListener('keydown', e => {
  if (e.key==='Escape') document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
});
document.addEventListener('click', e => {
  if (!e.target.closest('.dropdown-wrap')) {
    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
    document.querySelectorAll('.dropdown-trigger').forEach(t => t.classList.remove('open'));
  }
});

// Manufacturers pinned to top of specific categories (rendered in order before the shuffled rest)
const pinnedTop = {};

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
buildDropdowns();
applyFilters();
</script>

</body>
</html>
